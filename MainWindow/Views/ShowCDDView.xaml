<UserControl x:Class="SFTemplateGenerator.MainWindow.Views.ShowCDDView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SFTemplateGenerator.MainWindow.ViewModels"
             xmlns:cm="http://caliburnmicro.com"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <DockPanel>
        <DockPanel DockPanel.Dock="Top">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                <GridSplitter Width="3" Opacity="0"/>
                <Button
                materialDesign:ButtonAssist.CornerRadius="5"
                IsEnabled="{Binding  EnableGenerateButton}"
                Style="{StaticResource MaterialDesignRaisedLightButton}"
                ToolTip="MaterialDesignRaisedLightButton with Round Corners"
                cm:Message.Attach="[Event Click] = [Action GenerateTestTemplateButtonClicked($source, $eventArgs)]">
                    <TextBlock Text="生成模板" />
                </Button>
            </StackPanel>
            <Grid/>
        </DockPanel>

        <DataGrid AutoGenerateColumns="False"
              CanUserAddRows="False"
              Background="White"
              ItemsSource="{Binding Devices}">
            <DataGrid.Columns>

                <DataGridTemplateColumn Header="Select">
                    <DataGridTemplateColumn.HeaderTemplate>
                        <DataTemplate>
                            <CheckBox 
                            Content="全选" 
                            IsChecked="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.IsSelectAll}" 
                            IsEnabled="{Binding  RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.HasDevices}"
                            cm:Message.Attach="[Event Checked] = [Action SelectAllCheckBoxChecked($source, $eventArgs)]; [Event Unchecked] = [Action SelectAllCheckBoxUnChecked($source, $eventArgs)]"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.HeaderTemplate>
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                  cm:Message.Attach="[Event Checked] = [Action DeviceItemChecked($source, $dataContext, $eventArgs)]; [Event Unchecked] = [Action DeviceItemUnChecked($source, $dataContext, $eventArgs)]"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Binding="{Binding Device.Name}" Header="名称"/>
                <DataGridTextColumn Binding="{Binding Device.Desc}" Header="描述"/>
                <DataGridTextColumn Binding="{Binding Device.Model}" Header="装置"/>
            </DataGrid.Columns>
        </DataGrid>

    </DockPanel>
</UserControl>
